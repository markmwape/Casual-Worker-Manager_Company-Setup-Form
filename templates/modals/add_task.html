<div id="add-task-modal" class="modal">
    <div class="modal-box">
        <!-- Header Section -->
        <div class="modal-header">
            <div class="flex items-center gap-3 mb-2">
                <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center">
                    <i class="fas fa-plus text-white text-lg"></i>
                </div>
                <div>
                    <h3 class="text-2xl font-bold text-gray-900">Create New Task</h3>
                    <p class="text-sm text-gray-500">Add a new task to organize your work</p>
                </div>
            </div>
            <button type="button" class="modal-close-btn" onclick="closeAddTaskModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Error Alert -->
        <div id="task-date-error" class="error-alert" style="display:none;">
            <div class="flex items-center gap-2">
                <i class="fas fa-exclamation-triangle text-red-500"></i>
                <span class="error-text"></span>
            </div>
        </div>
            <form id="taskForm" onsubmit="createTask(event)" class="task-form">
                <!-- Task Name -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="label-text">Task Name</span>
                        <span class="label-required">*</span>
                    </label>
                    <div class="input-wrapper">
                        <div class="input-icon">
                            <i class="fas fa-tasks text-gray-400"></i>
                        </div>
                        <input type="text" name="name" class="form-input" placeholder="Enter a descriptive task name" required>
                    </div>
                </div>

                <!-- Description -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="label-text">Description</span>
                        <span class="label-optional">(Optional)</span>
                    </label>
                    <div class="input-wrapper">
                        <textarea name="description" class="form-textarea" placeholder="Describe what needs to be done..." rows="3"></textarea>
                    </div>
                </div>

                <!-- Start Date -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="label-text">Start Date</span>
                        <span class="label-required">*</span>
                    </label>
                    <div class="input-wrapper">
                        <div class="input-icon">
                            <i class="fas fa-calendar-alt text-gray-400"></i>
                        </div>
                        <input type="date" name="start_date" id="task-start-date" class="form-input" required value="{{ today_date }}" placeholder="Select start date">
                    </div>
                    <div id="task-status-indicator" class="status-indicator hidden">
                        <div class="flex items-center gap-2">
                            <div class="status-dot bg-blue-500"></div>
                            <span class="text-blue-800 font-medium text-sm">Status will be set to: <span id="task-status-value" class="font-bold">In Progress</span></span>
                        </div>
                    </div>
                </div>

                <!-- Payment Type -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="label-text">Payment Type</span>
                        <span class="label-required">*</span>
                    </label>
                    <div class="payment-type-grid">
                        <label class="payment-option">
                            <input type="radio" name="payment_type" value="per_day" class="payment-radio" checked>
                            <div class="payment-card">
                                <div class="payment-icon">
                                    <i class="fas fa-calendar-day text-green-600"></i>
                                </div>
                                <div class="payment-content">
                                    <span class="payment-title">Per Day</span>
                                    <p class="payment-description">Fixed daily rate for workers</p>
                                </div>
                                <div class="payment-check">
                                    <i class="fas fa-check text-white"></i>
                                </div>
                            </div>
                        </label>
                        <label class="payment-option">
                            <input type="radio" name="payment_type" value="per_part" class="payment-radio">
                            <div class="payment-card">
                                <div class="payment-icon">
                                    <i class="fas fa-cube text-blue-600"></i>
                                </div>
                                <div class="payment-content">
                                    <span class="payment-title">Per Part</span>
                                    <p class="payment-description">Payment based on units completed</p>
                                </div>
                                <div class="payment-check">
                                    <i class="fas fa-check text-white"></i>
                                </div>
                            </div>
                        </label>
                    </div>
                </div>
                <!-- Daily Payout Section -->
                <div class="form-group" id="per-day-payout-group">
                    <label class="form-label">
                        <span class="label-text" id="payout-label">Daily Payout per Worker</span>
                        <span class="label-required">*</span>
                    </label>
                    <div class="payout-grid">
                        <div class="input-wrapper">
                            <div class="input-icon">
                                <i class="fas fa-dollar-sign text-gray-400"></i>
                            </div>
                            <input type="number" step="0.01" min="0.01" name="per_day_payout" id="per-day-payout" class="form-input" placeholder="Enter amount" required>
                        </div>
                        <div class="select-wrapper">
                            <select name="per_day_currency" id="per-day-currency" class="form-select" required>
                                <option value="">Select Currency</option>
                        <option value="AED">AED - United Arab Emirates Dirham (د.إ)</option>
                        <option value="AFN">AFN - Afghani (؋)</option>
                        <option value="ALL">ALL - Albanian Lek (L)</option>
                        <option value="AMD">AMD - Armenian Dram (֏)</option>
                        <option value="ANG">ANG - Netherlands Antillean Guilder (ƒ)</option>
                        <option value="AOA">AOA - Angolan Kwanza (Kz)</option>
                        <option value="ARS">ARS - Argentine Peso ($)</option>
                        <option value="AUD">AUD - Australian Dollar ($)</option>
                        <option value="AWG">AWG - Aruban Florin (ƒ)</option>
                        <option value="AZN">AZN - Azerbaijani Manat (₼)</option>
                        <option value="BAM">BAM - Bosnia and Herzegovina Mark (KM)</option>
                        <option value="BBD">BBD - Barbadian Dollar ($)</option>
                        <option value="BDT">BDT - Bangladeshi Taka (৳)</option>
                        <option value="BGN">BGN - Bulgarian Lev (лв)</option>
                        <option value="BHD">BHD - Bahraini Dinar (.د.ب)</option>
                        <option value="BIF">BIF - Burundian Franc (FBu)</option>
                        <option value="BMD">BMD - Bermudian Dollar ($)</option>
                        <option value="BND">BND - Brunei Dollar ($)</option>
                        <option value="BOB">BOB - Bolivian Boliviano (Bs.)</option>
                        <option value="BRL">BRL - Brazilian Real (R$)</option>
                        <option value="BSD">BSD - Bahamian Dollar ($)</option>
                        <option value="BTN">BTN - Bhutanese Ngultrum (Nu.)</option>
                        <option value="BWP">BWP - Botswana Pula (P)</option>
                        <option value="BYN">BYN - Belarusian Ruble (Br)</option>
                        <option value="BZD">BZD - Belize Dollar ($)</option>
                        <option value="CAD">CAD - Canadian Dollar ($)</option>
                        <option value="CDF">CDF - Congolese Franc (Fr)</option>
                        <option value="CHF">CHF - Swiss Franc (Fr)</option>
                        <option value="CLP">CLP - Chilean Peso ($)</option>
                        <option value="CNY">CNY - Chinese Yuan (¥)</option>
                        <option value="COP">COP - Colombian Peso ($)</option>
                        <option value="CRC">CRC - Costa Rican Colón (₡)</option>
                        <option value="CUP">CUP - Cuban Peso ($)</option>
                        <option value="CVE">CVE - Cabo Verde Escudo ($)</option>
                        <option value="CZK">CZK - Czech Koruna (Kč)</option>
                        <option value="DJF">DJF - Djiboutian Franc (Fr)</option>
                        <option value="DKK">DKK - Danish Krone (kr)</option>
                        <option value="DOP">DOP - Dominican Peso ($)</option>
                        <option value="DZD">DZD - Algerian Dinar (د.ج)</option>
                        <option value="EGP">EGP - Egyptian Pound (£)</option>
                        <option value="ERN">ERN - Eritrean Nakfa (Nfk)</option>
                        <option value="ETB">ETB - Ethiopian Birr (Br)</option>
                        <option value="EUR">EUR - Euro (€)</option>
                        <option value="FJD">FJD - Fijian Dollar ($)</option>
                        <option value="FKP">FKP - Falkland Islands Pound (£)</option>
                        <option value="GBP">GBP - British Pound Sterling (£)</option>
                        <option value="GEL">GEL - Georgian Lari (₾)</option>
                        <option value="GHS">GHS - Ghanaian Cedi (₵)</option>
                        <option value="GIP">GIP - Gibraltar Pound (£)</option>
                        <option value="GMD">GMD - Gambian Dalasi (D)</option>
                        <option value="GNF">GNF - Guinean Franc (Fr)</option>
                        <option value="GTQ">GTQ - Guatemalan Quetzal (Q)</option>
                        <option value="GYD">GYD - Guyanese Dollar ($)</option>
                        <option value="HKD">HKD - Hong Kong Dollar ($)</option>
                        <option value="HNL">HNL - Honduran Lempira (L)</option>
                        <option value="HRK">HRK - Croatian Kuna (kn)</option>
                        <option value="HTG">HTG - Haitian Gourde (G)</option>
                        <option value="HUF">HUF - Hungarian Forint (Ft)</option>
                        <option value="IDR">IDR - Indonesian Rupiah (Rp)</option>
                        <option value="ILS">ILS - Israeli New Shekel (₪)</option>
                        <option value="INR">INR - Indian Rupee (₹)</option>
                        <option value="IQD">IQD - Iraqi Dinar (ع.د)</option>
                        <option value="IRR">IRR - Iranian Rial (﷼)</option>
                        <option value="ISK">ISK - Icelandic Króna (kr)</option>
                        <option value="JMD">JMD - Jamaican Dollar ($)</option>
                        <option value="JOD">JOD - Jordanian Dinar (د.ا)</option>
                        <option value="JPY">JPY - Japanese Yen (¥)</option>
                        <option value="KES">KES - Kenyan Shilling (Sh)</option>
                        <option value="KGS">KGS - Kyrgystani Som (с)</option>
                        <option value="KHR">KHR - Cambodian Riel (៛)</option>
                        <option value="KMF">KMF - Comorian Franc (Fr)</option>
                        <option value="KPW">KPW - North Korean Won (₩)</option>
                        <option value="KRW">KRW - South Korean Won (₩)</option>
                        <option value="KWD">KWD - Kuwaiti Dinar (د.ك)</option>
                        <option value="KZT">KZT - Kazakhstani Tenge (₸)</option>
                        <option value="LAK">LAK - Lao Kip (₭)</option>
                        <option value="LBP">LBP - Lebanese Pound (ل.ل)</option>
                        <option value="LKR">LKR - Sri Lankan Rupee (₨)</option>
                        <option value="LRD">LRD - Liberian Dollar ($)</option>
                        <option value="LSL">LSL - Lesotho Loti (L)</option>
                        <option value="LYD">LYD - Libyan Dinar (ل.د)</option>
                        <option value="MAD">MAD - Moroccan Dirham (د.م.)</option>
                        <option value="MDL">MDL - Moldovan Leu (L)</option>
                        <option value="MGA">MGA - Malagasy Ariary (Ar)</option>
                        <option value="MKD">MKD - Macedonian Denar (ден)</option>
                        <option value="MMK">MMK - Myanmar Kyat (K)</option>
                        <option value="MNT">MNT - Mongolian Tögrög (₮)</option>
                        <option value="MOP">MOP - Macanese Pataca (P)</option>
                        <option value="MRU">MRU - Mauritanian Ouguiya (UM)</option>
                        <option value="MUR">MUR - Mauritian Rupee (₨)</option>
                        <option value="MVR">MVR - Maldivian Rufiyaa (Rf)</option>
                        <option value="MWK">MWK - Malawian Kwacha (MK)</option>
                        <option value="MXN">MXN - Mexican Peso ($)</option>
                        <option value="MYR">MYR - Malaysian Ringgit (RM)</option>
                        <option value="MZN">MZN - Mozambican Metical (MT)</option>
                        <option value="NAD">NAD - Namibian Dollar ($)</option>
                        <option value="NGN">NGN - Nigerian Naira (₦)</option>
                        <option value="NIO">NIO - Nicaraguan Córdoba (C$)</option>
                        <option value="NOK">NOK - Norwegian Krone (kr)</option>
                        <option value="NPR">NPR - Nepalese Rupee (₨)</option>
                        <option value="NZD">NZD - New Zealand Dollar ($)</option>
                        <option value="OMR">OMR - Omani Rial (ر.ع.)</option>
                        <option value="PAB">PAB - Panamanian Balboa (B/.)</option>
                        <option value="PEN">PEN - Peruvian Sol (S/.)</option>
                        <option value="PGK">PGK - Papua New Guinean Kina (K)</option>
                        <option value="PHP">PHP - Philippine Peso (₱)</option>
                        <option value="PKR">PKR - Pakistani Rupee (₨)</option>
                        <option value="PLN">PLN - Polish Złoty (zł)</option>
                        <option value="PYG">PYG - Paraguayan Guaraní (₲)</option>
                        <option value="QAR">QAR - Qatari Riyal (ر.ق)</option>
                        <option value="RON">RON - Romanian Leu (lei)</option>
                        <option value="RSD">RSD - Serbian Dinar (дин.)</option>
                        <option value="RUB">RUB - Russian Ruble (₽)</option>
                        <option value="RWF">RWF - Rwandan Franc (Fr)</option>
                        <option value="SAR">SAR - Saudi Riyal (ر.س)</option>
                        <option value="SBD">SBD - Solomon Islands Dollar ($)</option>
                        <option value="SCR">SCR - Seychellois Rupee (₨)</option>
                        <option value="SDG">SDG - Sudanese Pound (ج.س.)</option>
                        <option value="SEK">SEK - Swedish Krona (kr)</option>
                        <option value="SGD">SGD - Singapore Dollar ($)</option>
                        <option value="SHP">SHP - Saint Helena Pound (£)</option>
                        <option value="SLL">SLL - Sierra Leonean Leone (Le)</option>
                        <option value="SOS">SOS - Somali Shilling (Sh)</option>
                        <option value="SRD">SRD - Surinamese Dollar ($)</option>
                        <option value="SSP">SSP - South Sudanese Pound (£)</option>
                        <option value="STN">STN - São Tomé and Príncipe Dobra (Db)</option>
                        <option value="SVC">SVC - Salvadoran Colón (₡)</option>
                        <option value="SYP">SYP - Syrian Pound (£)</option>
                        <option value="SZL">SZL - Swazi Lilangeni (L)</option>
                        <option value="THB">THB - Thai Baht (฿)</option>
                        <option value="TJS">TJS - Tajikistani Somoni (ЅМ)</option>
                        <option value="TMT">TMT - Turkmenistani Manat (m)</option>
                        <option value="TND">TND - Tunisian Dinar (د.ت)</option>
                        <option value="TOP">TOP - Tongan Paʻanga (T$)</option>
                        <option value="TRY">TRY - Turkish Lira (₺)</option>
                        <option value="TTD">TTD - Trinidad and Tobago Dollar ($)</option>
                        <option value="TWD">TWD - New Taiwan Dollar (NT$)</option>
                        <option value="TZS">TZS - Tanzanian Shilling (Sh)</option>
                        <option value="UAH">UAH - Ukrainian Hryvnia (₴)</option>
                        <option value="UGX">UGX - Ugandan Shilling (Sh)</option>
                        <option value="USD">USD - United States Dollar ($)</option>
                        <option value="UYU">UYU - Uruguayan Peso ($)</option>
                        <option value="UZS">UZS - Uzbekistani Som (so'm)</option>
                        <option value="VES">VES - Venezuelan Bolívar Soberano (Bs.S)</option>
                        <option value="VND">VND - Vietnamese Đồng (₫)</option>
                        <option value="VUV">VUV - Vanuatu Vatu (Vt)</option>
                        <option value="WST">WST - Samoan Tālā (T)</option>
                        <option value="XAF">XAF - Central African CFA Franc (Fr)</option>
                        <option value="XCD">XCD - East Caribbean Dollar ($)</option>
                        <option value="XOF">XOF - West African CFA Franc (Fr)</option>
                        <option value="XPF">XPF - CFP Franc (Fr)</option>
                        <option value="YER">YER - Yemeni Rial (﷼)</option>
                        <option value="ZAR">ZAR - South African Rand (R)</option>
                        <option value="ZMW">ZMW - Zambian Kwacha (K)</option>
                        <option value="ZWL">ZWL - Zimbabwean Dollar ($)</option>
                        </select>
                        <div class="select-icon">
                            <i class="fas fa-chevron-down text-gray-400"></i>
                        </div>
                    </div>
                    </div>
                    <div class="payout-hint">
                        <i class="fas fa-info-circle text-blue-500"></i>
                        <span class="text-sm text-gray-600">e.g., 25$, 60 Kwacha</span>
                    </div>
                </div>

                <!-- Per Part Payout Section -->
                <div class="form-group" id="per-part-payout-group" style="display:none;">
                    <label class="form-label">
                        <span class="label-text">Payout per Part</span>
                        <span class="label-required">*</span>
                    </label>
                    <div class="payout-grid">
                        <div class="input-wrapper">
                            <div class="input-icon">
                                <i class="fas fa-dollar-sign text-gray-400"></i>
                            </div>
                            <input type="number" step="0.01" min="0.01" name="per_part_payout" id="per-part-payout" class="form-input" placeholder="Enter amount per part">
                        </div>
                        <div class="select-wrapper">
                            <select name="per_part_currency" id="per-part-currency" class="form-select">
                                <option value="">Select Currency</option>
                        <option value="AED">AED - United Arab Emirates Dirham (د.إ)</option>
                        <option value="AFN">AFN - Afghani (؋)</option>
                        <option value="ALL">ALL - Albanian Lek (L)</option>
                        <option value="AMD">AMD - Armenian Dram (֏)</option>
                        <option value="ANG">ANG - Netherlands Antillean Guilder (ƒ)</option>
                        <option value="AOA">AOA - Angolan Kwanza (Kz)</option>
                        <option value="ARS">ARS - Argentine Peso ($)</option>
                        <option value="AUD">AUD - Australian Dollar ($)</option>
                        <option value="AWG">AWG - Aruban Florin (ƒ)</option>
                        <option value="AZN">AZN - Azerbaijani Manat (₼)</option>
                        <option value="BAM">BAM - Bosnia and Herzegovina Mark (KM)</option>
                        <option value="BBD">BBD - Barbadian Dollar ($)</option>
                        <option value="BDT">BDT - Bangladeshi Taka (৳)</option>
                        <option value="BGN">BGN - Bulgarian Lev (лв)</option>
                        <option value="BHD">BHD - Bahraini Dinar (.د.ب)</option>
                        <option value="BIF">BIF - Burundian Franc (FBu)</option>
                        <option value="BMD">BMD - Bermudian Dollar ($)</option>
                        <option value="BND">BND - Brunei Dollar ($)</option>
                        <option value="BOB">BOB - Bolivian Boliviano (Bs.)</option>
                        <option value="BRL">BRL - Brazilian Real (R$)</option>
                        <option value="BSD">BSD - Bahamian Dollar ($)</option>
                        <option value="BTN">BTN - Bhutanese Ngultrum (Nu.)</option>
                        <option value="BWP">BWP - Botswana Pula (P)</option>
                        <option value="BYN">BYN - Belarusian Ruble (Br)</option>
                        <option value="BZD">BZD - Belize Dollar ($)</option>
                        <option value="CAD">CAD - Canadian Dollar ($)</option>
                        <option value="CDF">CDF - Congolese Franc (Fr)</option>
                        <option value="CHF">CHF - Swiss Franc (Fr)</option>
                        <option value="CLP">CLP - Chilean Peso ($)</option>
                        <option value="CNY">CNY - Chinese Yuan (¥)</option>
                        <option value="COP">COP - Colombian Peso ($)</option>
                        <option value="CRC">CRC - Costa Rican Colón (₡)</option>
                        <option value="CUP">CUP - Cuban Peso ($)</option>
                        <option value="CVE">CVE - Cabo Verde Escudo ($)</option>
                        <option value="CZK">CZK - Czech Koruna (Kč)</option>
                        <option value="DJF">DJF - Djiboutian Franc (Fr)</option>
                        <option value="DKK">DKK - Danish Krone (kr)</option>
                        <option value="DOP">DOP - Dominican Peso ($)</option>
                        <option value="DZD">DZD - Algerian Dinar (د.ج)</option>
                        <option value="EGP">EGP - Egyptian Pound (£)</option>
                        <option value="ERN">ERN - Eritrean Nakfa (Nfk)</option>
                        <option value="ETB">ETB - Ethiopian Birr (Br)</option>
                        <option value="EUR">EUR - Euro (€)</option>
                        <option value="FJD">FJD - Fijian Dollar ($)</option>
                        <option value="FKP">FKP - Falkland Islands Pound (£)</option>
                        <option value="GBP">GBP - British Pound Sterling (£)</option>
                        <option value="GEL">GEL - Georgian Lari (₾)</option>
                        <option value="GHS">GHS - Ghanaian Cedi (₵)</option>
                        <option value="GIP">GIP - Gibraltar Pound (£)</option>
                        <option value="GMD">GMD - Gambian Dalasi (D)</option>
                        <option value="GNF">GNF - Guinean Franc (Fr)</option>
                        <option value="GTQ">GTQ - Guatemalan Quetzal (Q)</option>
                        <option value="GYD">GYD - Guyanese Dollar ($)</option>
                        <option value="HKD">HKD - Hong Kong Dollar ($)</option>
                        <option value="HNL">HNL - Honduran Lempira (L)</option>
                        <option value="HRK">HRK - Croatian Kuna (kn)</option>
                        <option value="HTG">HTG - Haitian Gourde (G)</option>
                        <option value="HUF">HUF - Hungarian Forint (Ft)</option>
                        <option value="IDR">IDR - Indonesian Rupiah (Rp)</option>
                        <option value="ILS">ILS - Israeli New Shekel (₪)</option>
                        <option value="INR">INR - Indian Rupee (₹)</option>
                        <option value="IQD">IQD - Iraqi Dinar (ع.د)</option>
                        <option value="IRR">IRR - Iranian Rial (﷼)</option>
                        <option value="ISK">ISK - Icelandic Króna (kr)</option>
                        <option value="JMD">JMD - Jamaican Dollar ($)</option>
                        <option value="JOD">JOD - Jordanian Dinar (د.ا)</option>
                        <option value="JPY">JPY - Japanese Yen (¥)</option>
                        <option value="KES">KES - Kenyan Shilling (Sh)</option>
                        <option value="KGS">KGS - Kyrgystani Som (с)</option>
                        <option value="KHR">KHR - Cambodian Riel (៛)</option>
                        <option value="KMF">KMF - Comorian Franc (Fr)</option>
                        <option value="KPW">KPW - North Korean Won (₩)</option>
                        <option value="KRW">KRW - South Korean Won (₩)</option>
                        <option value="KWD">KWD - Kuwaiti Dinar (د.ك)</option>
                        <option value="KZT">KZT - Kazakhstani Tenge (₸)</option>
                        <option value="LAK">LAK - Lao Kip (₭)</option>
                        <option value="LBP">LBP - Lebanese Pound (ل.ل)</option>
                        <option value="LKR">LKR - Sri Lankan Rupee (₨)</option>
                        <option value="LRD">LRD - Liberian Dollar ($)</option>
                        <option value="LSL">LSL - Lesotho Loti (L)</option>
                        <option value="LYD">LYD - Libyan Dinar (ل.د)</option>
                        <option value="MAD">MAD - Moroccan Dirham (د.م.)</option>
                        <option value="MDL">MDL - Moldovan Leu (L)</option>
                        <option value="MGA">MGA - Malagasy Ariary (Ar)</option>
                        <option value="MKD">MKD - Macedonian Denar (ден)</option>
                        <option value="MMK">MMK - Myanmar Kyat (K)</option>
                        <option value="MNT">MNT - Mongolian Tögrög (₮)</option>
                        <option value="MOP">MOP - Macanese Pataca (P)</option>
                        <option value="MRU">MRU - Mauritanian Ouguiya (UM)</option>
                        <option value="MUR">MUR - Mauritian Rupee (₨)</option>
                        <option value="MVR">MVR - Maldivian Rufiyaa (Rf)</option>
                        <option value="MWK">MWK - Malawian Kwacha (MK)</option>
                        <option value="MXN">MXN - Mexican Peso ($)</option>
                        <option value="MYR">MYR - Malaysian Ringgit (RM)</option>
                        <option value="MZN">MZN - Mozambican Metical (MT)</option>
                        <option value="NAD">NAD - Namibian Dollar ($)</option>
                        <option value="NGN">NGN - Nigerian Naira (₦)</option>
                        <option value="NIO">NIO - Nicaraguan Córdoba (C$)</option>
                        <option value="NOK">NOK - Norwegian Krone (kr)</option>
                        <option value="NPR">NPR - Nepalese Rupee (₨)</option>
                        <option value="NZD">NZD - New Zealand Dollar ($)</option>
                        <option value="OMR">OMR - Omani Rial (ر.ع.)</option>
                        <option value="PAB">PAB - Panamanian Balboa (B/.)</option>
                        <option value="PEN">PEN - Peruvian Sol (S/.)</option>
                        <option value="PGK">PGK - Papua New Guinean Kina (K)</option>
                        <option value="PHP">PHP - Philippine Peso (₱)</option>
                        <option value="PKR">PKR - Pakistani Rupee (₨)</option>
                        <option value="PLN">PLN - Polish Złoty (zł)</option>
                        <option value="PYG">PYG - Paraguayan Guaraní (₲)</option>
                        <option value="QAR">QAR - Qatari Riyal (ر.ق)</option>
                        <option value="RON">RON - Romanian Leu (lei)</option>
                        <option value="RSD">RSD - Serbian Dinar (дин.)</option>
                        <option value="RUB">RUB - Russian Ruble (₽)</option>
                        <option value="RWF">RWF - Rwandan Franc (Fr)</option>
                        <option value="SAR">SAR - Saudi Riyal (ر.س)</option>
                        <option value="SBD">SBD - Solomon Islands Dollar ($)</option>
                        <option value="SCR">SCR - Seychellois Rupee (₨)</option>
                        <option value="SDG">SDG - Sudanese Pound (ج.س.)</option>
                        <option value="SEK">SEK - Swedish Krona (kr)</option>
                        <option value="SGD">SGD - Singapore Dollar ($)</option>
                        <option value="SHP">SHP - Saint Helena Pound (£)</option>
                        <option value="SLL">SLL - Sierra Leonean Leone (Le)</option>
                        <option value="SOS">SOS - Somali Shilling (Sh)</option>
                        <option value="SRD">SRD - Surinamese Dollar ($)</option>
                        <option value="SSP">SSP - South Sudanese Pound (£)</option>
                        <option value="STN">STN - São Tomé and Príncipe Dobra (Db)</option>
                        <option value="SVC">SVC - Salvadoran Colón (₡)</option>
                        <option value="SYP">SYP - Syrian Pound (£)</option>
                        <option value="SZL">SZL - Swazi Lilangeni (L)</option>
                        <option value="THB">THB - Thai Baht (฿)</option>
                        <option value="TJS">TJS - Tajikistani Somoni (ЅМ)</option>
                        <option value="TMT">TMT - Turkmenistani Manat (m)</option>
                        <option value="TND">TND - Tunisian Dinar (د.ت)</option>
                        <option value="TOP">TOP - Tongan Paʻanga (T$)</option>
                        <option value="TRY">TRY - Turkish Lira (₺)</option>
                        <option value="TTD">TTD - Trinidad and Tobago Dollar ($)</option>
                        <option value="TWD">TWD - New Taiwan Dollar (NT$)</option>
                        <option value="TZS">TZS - Tanzanian Shilling (Sh)</option>
                        <option value="UAH">UAH - Ukrainian Hryvnia (₴)</option>
                        <option value="UGX">UGX - Ugandan Shilling (Sh)</option>
                        <option value="USD">USD - United States Dollar ($)</option>
                        <option value="UYU">UYU - Uruguayan Peso ($)</option>
                        <option value="UZS">UZS - Uzbekistani Som (so'm)</option>
                        <option value="VES">VES - Venezuelan Bolívar Soberano (Bs.S)</option>
                        <option value="VND">VND - Vietnamese Đồng (₫)</option>
                        <option value="VUV">VUV - Vanuatu Vatu (Vt)</option>
                        <option value="WST">WST - Samoan Tālā (T)</option>
                        <option value="XAF">XAF - Central African CFA Franc (Fr)</option>
                        <option value="XCD">XCD - East Caribbean Dollar ($)</option>
                        <option value="XOF">XOF - West African CFA Franc (Fr)</option>
                        <option value="XPF">XPF - CFP Franc (Fr)</option>
                        <option value="YER">YER - Yemeni Rial (﷼)</option>
                        <option value="ZAR">ZAR - South African Rand (R)</option>
                        <option value="ZMW">ZMW - Zambian Kwacha (K)</option>
                        <option value="ZWL">ZWL - Zimbabwean Dollar ($)</option>
                        </select>
                            <div class="select-icon">
                                <i class="fas fa-chevron-down text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                    <div class="payout-hint">
                        <i class="fas fa-info-circle text-blue-500"></i>
                        <span class="text-sm text-gray-600">e.g., 25$, 60 Kwacha</span>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeAddTaskModal()">
                        <i class="fas fa-times mr-2"></i>Cancel
                    </button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-plus mr-2"></i>Create Task
                    </button>
                </div>
            </form>
        </div>
    </div>
    <form method="dialog" class="modal-backdrop">
        <button onclick="closeAddTaskModal()">close</button>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Payment type toggle functionality
    const paymentTypeRadios = document.querySelectorAll('input[name="payment_type"]');
    const payoutFields = document.getElementById('payout-fields');
    const perPartPayoutGroup = document.getElementById('per-part-payout-group');
    
    function updatePayoutDisplay() {
        const selectedType = document.querySelector('input[name="payment_type"]:checked');
        if (selectedType) {
            if (selectedType.value === 'fixed') {
                payoutFields.style.display = 'block';
                perPartPayoutGroup.style.display = 'none';
            } else if (selectedType.value === 'piece_rate') {
                payoutFields.style.display = 'none';
                perPartPayoutGroup.style.display = 'block';
            } else {
                payoutFields.style.display = 'none';
                perPartPayoutGroup.style.display = 'none';
            }
        }
    }
    
    paymentTypeRadios.forEach(radio => {
        radio.addEventListener('change', updatePayoutDisplay);
    });
    
    // Initialize the display
    updatePayoutDisplay();
    
    // Form validation and submission
    const addTaskForm = document.getElementById('addTaskForm');
    if (addTaskForm) {
        addTaskForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Basic validation
            const taskName = document.getElementById('task-name').value.trim();
            const paymentType = document.querySelector('input[name="payment_type"]:checked');
            
            if (!taskName) {
                alert('Please enter a task name');
                return;
            }
            
            if (!paymentType) {
                alert('Please select a payment type');
                return;
            }
            
            // Additional validation for payout fields if needed
            if (paymentType.value === 'fixed') {
                const payout = document.getElementById('payout').value;
                const currency = document.getElementById('currency').value;
                if (!payout || !currency) {
                    alert('Please enter payout amount and select currency');
                    return;
                }
            } else if (paymentType.value === 'piece_rate') {
                const perPartPayout = document.getElementById('per-part-payout').value;
                const perPartCurrency = document.getElementById('per-part-currency').value;
                if (!perPartPayout || !perPartCurrency) {
                    alert('Please enter per part payout amount and select currency');
                    return;
                }
            }
            
            const formData = new FormData(this);
            const submitButton = this.querySelector('button[type="submit"]');
            const originalText = submitButton.innerHTML;
            
            // Show loading state
            submitButton.innerHTML = `
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="animate-spin">
                    <path d="M21 12a9 9 0 11-6.219-8.56"/>
                </svg>
                Creating...
            `;
            submitButton.disabled = true;
            
            // Submit the form
            fetch('/tasks', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    closeAddTaskModal();
                    window.location.reload();
                } else {
                    throw new Error('Failed to create task');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Failed to create task. Please try again.');
            })
            .finally(() => {
                // Restore button state
                submitButton.innerHTML = originalText;
                submitButton.disabled = false;
            });
        });
    }
});

function closeAddTaskModal() {
    const modal = document.getElementById('add-task-modal');
    const form = document.getElementById('addTaskForm');
    
    // Reset form
    if (form) {
        form.reset();
        
        // Reset payment type display
        const payoutFields = document.getElementById('payout-fields');
        const perPartPayoutGroup = document.getElementById('per-part-payout-group');
        
        payoutFields.style.display = 'none';
        perPartPayoutGroup.style.display = 'none';
    }
    
    // Close modal
    if (modal) {
        modal.close();
    }
}
</script>